<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teacher Dashboard - Gamified Platform</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 font-sans">

<!-- Header -->
<header class="bg-gradient-to-r from-green-500 to-green-700 text-white p-6 shadow-lg flex justify-between items-center">
    <h1 class="text-3xl font-bold tracking-wide">Teacher Dashboard</h1>
    <div class="flex items-center space-x-4">
        <div class="text-lg">Welcome, <strong>Mr.Virat Prem Kohli</strong></div>
        <button class="bg-white text-green-600 px-4 py-2 rounded-full shadow hover:bg-gray-200 transition">Logout</button>
    </div>
</header>

<main class="p-6 grid grid-cols-1 lg:grid-cols-3 gap-6">

    <!-- Pending Tasks Section -->
    <section class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-lg">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-2xl font-semibold border-b pb-2">Pending Eco-Tasks</h2>
            <select id="filterStatus" class="border rounded p-1">
                <option value="all">All</option>
                <option value="pending">Pending</option>
                <option value="approved">Approved</option>
                <option value="rejected">Rejected</option>
            </select>
        </div>
        <input type="text" id="searchTask" placeholder="Search by student or task..." class="w-full mb-4 p-2 border rounded"/>
        <div id="task-list" class="space-y-4"></div>
    </section>

    <!-- Leaderboard Section -->
    <section class="bg-white p-6 rounded-2xl shadow-lg">
        <h2 class="text-2xl font-semibold mb-4 border-b pb-2">Class Leaderboard</h2>
        <ul id="leaderboard" class="space-y-3"></ul>
    </section>

</main>

<!-- Modal -->
<div id="taskModal" class="fixed inset-0 bg-black bg-opacity-50 hidden justify-center items-center">
    <div class="bg-white rounded-xl p-6 w-96 relative">
        <button id="closeModal" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700"><i class="fa-solid fa-xmark"></i></button>
        <h3 class="text-xl font-semibold mb-2" id="modalStudent"></h3>
        <p class="mb-1" id="modalAction"></p>
        <p class="mb-1" id="modalProof"></p>
        <p class="text-gray-500" id="modalStatus"></p>
        <p class="text-gray-500" id="modalPoints"></p>
    </div>
</div>

<script>
let tasks = [
    {id: 1, student: 'Aarav', action: 'Planted a tree', proof: '🌳', status: 'pending', points: 50},
    {id: 2, student: 'Diya', action: 'Segregated waste', proof: '♻️', status: 'pending', points: 30},
    {id: 3, student: 'Rohan', action: 'Saved water', proof: '💧', status: 'approved', points: 20}
];

let leaderboardData = [
    {student: 'Aarav', points: 120},
    {student: 'Diya', points: 100},
    {student: 'Rohan', points: 80}
];

// Render tasks
function renderTasks(filter="all", search="") {
    const taskList = document.getElementById('task-list');
    taskList.innerHTML = "";
    tasks
    .filter(t => filter === "all" || t.status === filter)
    .filter(t => t.student.toLowerCase().includes(search.toLowerCase()) || t.action.toLowerCase().includes(search.toLowerCase()))
    .forEach((task, index) => {
        const statusColor = task.status === 'pending' ? 'bg-yellow-200 text-yellow-800' :
                            task.status === 'approved' ? 'bg-green-200 text-green-800' :
                            'bg-red-200 text-red-800';

        const card = document.createElement('div');
        card.className = "bg-green-50 p-5 rounded-xl shadow-md flex justify-between items-center transition hover:scale-105 cursor-pointer";
        card.innerHTML = `
            <div>
                <p class="text-lg font-medium"><i class="fa-solid fa-user text-green-600 mr-2"></i>${task.student}</p>
                <p class="text-gray-700 mt-1">${task.action} <span class="text-xl">${task.proof}</span></p>
                <p class="text-sm mt-1 ${statusColor} px-2 py-1 rounded inline-block">${task.status}</p>
                <p class="text-sm text-gray-500 mt-1">Points: ${task.points}</p>
            </div>
            <div class="flex space-x-2">
                <button class="approve-btn bg-green-500 text-white px-4 py-2 rounded-lg shadow hover:bg-green-600 transition">Approve</button>
                <button class="reject-btn bg-red-500 text-white px-4 py-2 rounded-lg shadow hover:bg-red-600 transition">Reject</button>
            </div>
        `;
        taskList.appendChild(card);

        // Click on card opens modal
        card.addEventListener('click', (e) => {
            if (!e.target.classList.contains('approve-btn') && !e.target.classList.contains('reject-btn')) {
                document.getElementById('modalStudent').innerText = task.student;
                document.getElementById('modalAction').innerText = `Action: ${task.action}`;
                document.getElementById('modalProof').innerText = `Proof: ${task.proof}`;
                document.getElementById('modalStatus').innerText = `Status: ${task.status}`;
                document.getElementById('modalPoints').innerText = `Points: ${task.points}`;
                document.getElementById('taskModal').classList.remove('hidden');
            }
        });

        // Approve/Reject
        card.querySelector('.approve-btn').addEventListener('click', (event) => {
            event.stopPropagation();
            task.status = 'approved';
            alert(`${task.student}'s task approved!`);
            renderTasks(document.getElementById('filterStatus').value, document.getElementById('searchTask').value);
        });
        card.querySelector('.reject-btn').addEventListener('click', (event) => {
            event.stopPropagation();
            task.status = 'rejected';
            alert(`${task.student}'s task rejected.`);
            renderTasks(document.getElementById('filterStatus').value, document.getElementById('searchTask').value);
        });
    });
}

// Render leaderboard
function renderLeaderboard() {
    const leaderboard = document.getElementById('leaderboard');
    leaderboard.innerHTML = "";
    leaderboardData.sort((a,b)=>b.points-a.points).forEach((student, idx)=>{
        const li = document.createElement('li');
        li.className="flex justify-between bg-gray-50 p-3 rounded shadow hover:scale-105 transition";
        li.innerHTML = `<span>${idx+1}. ${student.student}</span> <span>${student.points} pts</span>`;
        leaderboard.appendChild(li);
    });
}

// Filter & Search events
document.getElementById('filterStatus').addEventListener('change', () => {
    renderTasks(document.getElementById('filterStatus').value, document.getElementById('searchTask').value);
});
document.getElementById('searchTask').addEventListener('input', () => {
    renderTasks(document.getElementById('filterStatus').value, document.getElementById('searchTask').value);
});

// Modal close
document.getElementById('closeModal').addEventListener('click', () => {
    document.getElementById('taskModal').classList.add('hidden');
});

// Initial render
renderTasks();
renderLeaderboard();
</script>

</body>
</html>
